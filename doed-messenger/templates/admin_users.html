<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Doed Admin - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</title>
    <style>
        *{margin:0;padding:0;box-sizing:border-box;font-family:'Segoe UI',sans-serif;}
        :root{
            --red:#e63946;--dark-red:#d00000;--blue:#4a6fa5;--purple:#8a2be2;
            --dark:#1a1a2e;--light:#16213e;--text:#f1faee;--gray:#a8dadc;
            --border:#2d3047;--green:#32CD32;--yellow:#ffd700;
        }
        body{background:var(--dark);color:var(--text);}
        .header{
            background:var(--light);
            padding:20px;
            border-bottom:3px solid var(--red);
            display:flex;
            justify-content:space-between;
            align-items:center;
        }
        .header h1{
            color:var(--red);
        }
        .admin-badge{
            background:var(--purple);
            color:white;
            padding:5px 10px;
            border-radius:20px;
            font-size:12px;
        }
        .container{
            display:flex;
            min-height:100vh;
        }
        .sidebar{
            width:250px;
            background:var(--light);
            padding:20px;
            border-right:2px solid var(--border);
        }
        .sidebar a{
            display:block;
            color:var(--text);
            text-decoration:none;
            padding:12px 15px;
            margin:5px 0;
            border-radius:8px;
            transition:all 0.3s;
        }
        .sidebar a:hover{
            background:var(--red);
            transform:translateX(5px);
        }
        .sidebar a.active{
            background:var(--red);
        }
        .content{
            flex:1;
            padding:20px;
        }
        .content h2{
            margin-bottom:20px;
            color:var(--red);
        }
        .search-form{
            margin-bottom:20px;
            display:flex;
            gap:10px;
        }
        .search-input{
            flex:1;
            padding:12px;
            background:var(--light);
            border:2px solid var(--border);
            border-radius:8px;
            color:var(--text);
            font-size:14px;
        }
        .search-input:focus{
            outline:none;
            border-color:var(--red);
        }
        .search-btn{
            padding:12px 20px;
            background:var(--red);
            color:white;
            border:none;
            border-radius:8px;
            cursor:pointer;
            transition:all 0.3s;
        }
        .search-btn:hover{
            background:var(--dark-red);
        }
        .table{
            width:100%;
            border-collapse:collapse;
            background:var(--light);
            border-radius:10px;
            overflow:hidden;
            box-shadow:0 4px 15px rgba(0,0,0,0.3);
        }
        .table th{
            background:var(--red);
            padding:15px;
            text-align:left;
            font-weight:bold;
        }
        .table td{
            padding:12px 15px;
            border-bottom:1px solid var(--border);
        }
        .table tr:hover{
            background:rgba(230,57,70,0.1);
        }
        .status-online{
            color:var(--green);
            font-weight:bold;
        }
        .status-offline{
            color:var(--gray);
        }
        .status-banned{
            color:var(--red);
            font-weight:bold;
        }
        .btn{
            display:inline-block;
            padding:8px 15px;
            border-radius:5px;
            text-decoration:none;
            margin:2px;
            border:none;
            cursor:pointer;
            font-size:13px;
            transition:all 0.3s;
        }
        .btn-danger{
            background:var(--red);
            color:white;
        }
        .btn-danger:hover{
            background:var(--dark-red);
            transform:translateY(-2px);
        }
        .btn-success{
            background:var(--green);
            color:white;
        }
        .btn-success:hover{
            background:#2ecc71;
            transform:translateY(-2px);
        }
        .btn-primary{
            background:var(--blue);
            color:white;
        }
        .btn-primary:hover{
            background:#2980b9;
            transform:translateY(-2px);
        }
        .admin-tag{
            background:var(--purple);
            color:white;
            padding:3px 8px;
            border-radius:12px;
            font-size:11px;
        }
        .stats{
            display:grid;
            grid-template-columns:repeat(auto-fit, minmax(200px, 1fr));
            gap:20px;
            margin-bottom:30px;
        }
        .stat-card{
            background:var(--light);
            padding:20px;
            border-radius:10px;
            border-left:3px solid var(--red);
        }
        .stat-value{
            font-size:32px;
            font-weight:bold;
            color:var(--red);
        }
        .pagination{
            margin-top:20px;
            display:flex;
            gap:10px;
            justify-content:center;
        }
        .pagination a{
            padding:8px 12px;
            background:var(--light);
            color:var(--text);
            text-decoration:none;
            border-radius:5px;
            border:1px solid var(--border);
        }
        .pagination a:hover{
            background:var(--red);
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üî¥ Doed Admin Panel</h1>
        <div>
            <span class="admin-badge">üëë –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä: {{ admin.username }}</span>
        </div>
    </div>
    <div class="container">
        <div class="sidebar">
            <a href="/admin/">üè† –ì–ª–∞–≤–Ω–∞—è</a>
            <a href="/admin/users" class="active">üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</a>
            <a href="/admin/messages">üí¨ –°–æ–æ–±—â–µ–Ω–∏—è</a>
            <a href="/admin/reports">‚ö†Ô∏è –ñ–∞–ª–æ–±—ã</a>
            <a href="/chat">‚Ü©Ô∏è –í–µ—Ä–Ω—É—Ç—å—Å—è –≤ —á–∞—Ç</a>
            <a href="/logout">üö™ –í—ã–π—Ç–∏</a>
        </div>
        <div class="content">
            <h2>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏</h2>
            
            <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ -->
            <div class="stats">
                <div class="stat-card">
                    <div>–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</div>
                    <div class="stat-value">{{ users|length }}</div>
                </div>
                <div class="stat-card">
                    <div>–ê–∫—Ç–∏–≤–Ω—ã—Ö</div>
                    <div class="stat-value">{{ users|selectattr('status', 'equalto', '–≤ —Å–µ—Ç–∏')|list|length }}</div>
                </div>
                <div class="stat-card">
                    <div>–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</div>
                    <div class="stat-value">{{ users|selectattr('status', 'equalto', '–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω')|list|length }}</div>
                </div>
            </div>
            
            <!-- –ü–æ–∏—Å–∫ -->
            <form class="search-form" method="get">
                <input type="text" name="search" class="search-input" placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏, —Ç–µ–≥—É –∏–ª–∏ email..." value="{{ search or '' }}">
                <button type="submit" class="search-btn">–ù–∞–π—Ç–∏</button>
                {% if search %}
                <a href="/admin/users" class="btn btn-primary">–°–±—Ä–æ—Å–∏—Ç—å</a>
                {% endif %}
            </form>
            
            <!-- –¢–∞–±–ª–∏—Ü–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
            <table class="table">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>–ê–≤–∞—Ç–∞—Ä</th>
                        <th>–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</th>
                        <th>–¢–µ–≥</th>
                        <th>Email</th>
                        <th>–°—Ç–∞—Ç—É—Å</th>
                        <th>–†–æ–ª—å</th>
                        <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                        <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                    </tr>
                </thead>
                <tbody>
                    {% for user in users %}
                    <tr>
                        <td>{{ user.id }}</td>
                        <td>
                            <div style="width:35px;height:35px;border-radius:50%;background:linear-gradient(135deg,var(--purple),var(--blue));display:flex;align-items:center;justify-content:center;">
                                {{ user.avatar }}
                            </div>
                        </td>
                        <td><strong>{{ user.username }}</strong></td>
                        <td>@{{ user.tag }}</td>
                        <td>{{ user.email }}</td>
                        <td>
                            {% if user.status == '–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω' %}
                                <span class="status-banned">üî® –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>
                            {% elif user.status == '–≤ —Å–µ—Ç–∏' %}
                                <span class="status-online">üü¢ –í —Å–µ—Ç–∏</span>
                            {% else %}
                                <span class="status-offline">‚ö´ {{ user.status }}</span>
                            {% endif %}
                        </td>
                        <td>
                            {% if user.is_admin %}
                                <span class="admin-tag">üëë –ê–¥–º–∏–Ω</span>
                            {% else %}
                                <span class="admin-tag" style="background:var(--gray);">üë§ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å</span>
                            {% endif %}
                        </td>
                        <td>{{ user.created_at.strftime('%Y-%m-%d') if user.created_at else '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ' }}</td>
                        <td>
                            {% if user.email == 'sergeykatkov213@gmail.com' %}
                                <span class="admin-tag">üëë –ì–ª–∞–≤–Ω—ã–π –∞–¥–º–∏–Ω</span>
                            {% else %}
                                {% if user.status == '–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω' %}
                                <form method="post" action="/admin/users/{{ user.id }}/unban" style="display:inline;">
                                    <button type="submit" class="btn btn-success" onclick="return confirm('–†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {{ user.username }}?')">üîì –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
                                </form>
                                {% else %}
                                <form method="post" action="/admin/users/{{ user.id }}/ban" style="display:inline;">
                                    <button type="submit" class="btn btn-danger" onclick="return confirm('–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è {{ user.username }}?')">üî® –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å</button>
                                </form>
                                {% endif %}
                                
                                {% if not user.is_admin %}
                                <form method="post" action="/admin/users/{{ user.id }}/make-admin" style="display:inline;">
                                    <button type="submit" class="btn btn-primary" onclick="return confirm('–°–¥–µ–ª–∞—Ç—å {{ user.username }} –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º?')">üëë –°–¥–µ–ª–∞—Ç—å –∞–¥–º–∏–Ω–æ–º</button>
                                </form>
                                {% else %}
                                <form method="post" action="/admin/users/{{ user.id }}/remove-admin" style="display:inline;">
                                    <button type="submit" class="btn btn-warning" onclick="return confirm('–ó–∞–±—Ä–∞—Ç—å –ø—Ä–∞–≤–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —É {{ user.username }}?')">‚¨áÔ∏è –£–±—Ä–∞—Ç—å –∞–¥–º–∏–Ω–∞</button>
                                </form>
                                {% endif %}
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
            
            {% if not users %}
            <div style="text-align:center; padding:50px; background:var(--light); border-radius:10px;">
                <p>–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</p>
            </div>
            {% endif %}
        </div>
    </div>
</body>
</html>